from __future__ import print_function # Python 2/3 compatibility
import boto3
import json
import decimal
from boto3.dynamodb.conditions import Key, Attr

dynamodb = boto3.resource('dynamodb', region_name='us-east-1')
table = dynamodb.Table('Polarity-Scores')

class DecimalEncoder(json.JSONEncoder):
    def default(self, o):
        if isinstance(o, decimal.Decimal):
            if o % 1 > 0:
                return float(o)
            else:
                return int(o)
        return super(DecimalEncoder, self).default(o)

#Polarity Scores for Google, Tesla, Apple, Microsoft, and Facebook from 2018-11-01 to 2019-11-01
googleScores = [["2018-11-01",0.125],["2018-11-02", 0.25],["2018-11-08", 0.25],["2018-11-11", 0.0],["2018-11-14", 0.04545454545454545],["2018-11-18", 0.0],["2018-11-20", 0.0],["2018-11-22",-0.1375],["2018-11-24",0.0],["2018-11-27",0.21666666666666665],["2018-11-29",0.0],["2018-12-02",0.0],["2018-12-04",0.2],["2018-12-10",0.0],["2018-12-11",0.0],["2018-12-12",0.25],["2018-12-13",-0.07765151515151517],["2018-12-19",0.13636363636363635],["2018-12-20",0.0],["2019-01-10",0.14285714285714285],["2019-01-11",0.25],["2019-01-21",0.0],["2019-01-23",0.0],["2019-01-31",0.0],["2019-02-01",0.0],["2019-02-05",0.0],["2019-02-10",0.0],["2019-02-19",0.14285714285714285],["2019-02-21",0.125],["2019-02-22",0.0],["2019-03-06",0.0],["2019-03-08",0.0],["2019-03-09",0.125],["2019-03-10",0.2857142857142857],["2019-03-11",0.25],["2019-03-12",-0.00833333333333334],["2019-03-13",0.0],["2019-03-16",0.0],["2019-03-19",0.13636363636363635],["2019-03-20",-0.125],["2019-03-27",0.0],["2019-04-01",0.0],["2019-04-02",0.0],["2019-04-03",-0.15],["2019-04-05",0.0],["2019-04-09",0.3],["2019-04-17",-0.05],["2019-04-20",0.1],["2019-04-22",0.0],["2019-04-23",-0.1],["2019-04-26",-0.15555555555555559],["2019-04-27",0.0],["2019-04-28",0.10714285714285714],["2019-04-30",0.0],["2019-05-07",0.05357142857142857],["2019-05-10",0.0],["2019-05-13",0.4],["2019-05-14",0.0],["2019-05-17",0.0],["2019-05-20",0.2333333333333333],["2019-05-21",0.0],["2019-05-22",0.0],["2019-06-03",0.0],["2019-06-04",0.0],["2019-06-06",-0.4],["2019-06-07",0.10000000000000002],["2019-06-10",0.0],["2019-06-18",0.0],["2019-06-24",0.3416666666666666],["2019-06-25",0.0],["2019-06-27",-0.049999999999999996],["2019-06-28",0.06818181818181818],["2019-07-02",-0.25],["2019-07-03",0.06818181818181818],["2019-07-04",0.0],["2019-07-11",0.0],["2019-07-13",0.2],["2019-07-15",-0.03181818181818183],["2019-07-16",0.0],["2019-07-17",0.0],["2019-07-22",-0.1],["2019-07-25",0.0],["2019-07-26",0.0],["2019-08-06",-0.16666666666666666],["2019-08-07",0.0],["2019-08-12",0.0],["2019-08-16",0.0],["2019-08-19",0.0],["2019-08-23",0.5],["2019-08-27",0.0],["2019-08-31",0.13636363636363635],["2019-09-04",0.0],["2019-09-06",0.0],["2019-09-11",-0.14285714285714285],["2019-09-12",-0.25],["2019-09-13",0.0],["2019-09-15",0.0],["2019-09-19",-0.30000000000000004],["2019-09-20",0.0],["2019-09-23",0.0],["2019-09-24",0.0],["2019-10-03",-0.075],["2019-10-06",0.0],["2019-10-11",0.07142857142857142],["2019-10-15",0.0],["2019-10-16",0.0],["2019-10-21",0.35],["2019-10-23",0.0],["2019-10-29",0.03333333333333333],["2019-10-31",0.2125],["2019-11-01",0.0]]

teslaScores = [["2018-11-08",0.13636363636363635],["2019-01-02",0.0],["2019-01-18",0.0],["2019-01-30",0.0],["2019-02-18",0.3],["2019-03-01",0.0],["2019-03-02",0.0],["2019-03-11",0.0],["2019-03-14",0.13636363636363635],["2019-04-04",0.13636363636363635],["2019-04-05",6.938893903907228e-18],["2019-04-21",-0.1],["2019-04-26",0.0],["2019-05-02",0.0],["2019-05-18",0.0],["2019-05-21",-0.05555555555555556],["2019-07-09",-0.35714285714285715],["2019-09-05",0.0],["2019-09-10",0.0],["2019-10-24",0.0]]

appleScores = [["2018-11-01",0.0],["2018-11-02",0.0],["2018-11-15",0.0],["2018-11-16",-0.1708333333333333],["2018-11-20",0.0],["2018-11-21",0.0],["2018-12-02",-0.5],["2018-12-04",0.13636363636363635],["2018-12-12",0.05],["2018-12-24",0.0],["2019-01-03",-0.03203703703703703],["2019-01-06",0.25],["2019-01-08",0.21428571428571427],["2019-01-09",0.0],["2019-01-16",0.0],["2019-01-17",0.0],["2019-01-27",0.45],["2019-01-29",0.125],["2019-01-30",-0.16111111111111112],["2019-01-31",0.0],["2019-02-02",0.15],["2019-02-03",0.5],["2019-02-05",0.0],["2019-02-06",0.0],["2019-02-10",0.0],["2019-02-11",0.0],["2019-03-13",-0.5],["2019-03-18",0.13636363636363635],["2019-03-20",0.0],["2019-03-24",-0.03333333333333333],["2019-03-25",0.05555555555555556],["2019-03-26",0.0],["2019-03-27",0.0],["2019-03-29",0.0],["2019-03-30",0.0],["2019-04-01",0.16666666666666666],["2019-04-08",-0.5],["2019-04-30",0.25],["2019-05-05",0.2],["2019-05-06",-0.3],["2019-05-08",0.2857142857142857],["2019-05-13",-0.125],["2019-05-30",0.0],["2019-06-02",-0.1],["2019-06-03",0.25757575757575757],["2019-06-04",0.0],["2019-06-11",0.0],["2019-06-15",0.04545454545454545],["2019-06-21",0.0],["2019-06-25",0.5],["2019-06-27",-0.4],["2019-07-04",0.0],["2019-07-12",0.0],["2019-07-26",0.0],["2019-08-02",0.0],["2019-08-12",0.5],["2019-08-19",0.0],["2019-08-20",0.5],["2019-08-22",0.3181818181818182],["2019-08-25",0.0],["2019-08-28",0.0],["2019-08-29",0.0],["2019-09-06",0.0],["2019-09-10",0.010909090909090901],["2019-09-11",0.0],["2019-09-13",0.0],["2019-09-20",0.0],["2019-10-09",0.0],["2019-10-10",0.0],["2019-10-15",0.0],["2019-10-23",0.0],["2019-10-28",0.15],["2019-10-29",0.13636363636363635],["2019-10-30",0.0],["2019-10-31",0.0],["2019-11-01",0.13636363636363635]]

microSoftScores = [["2018-11-10",0.04999999999999999],["2018-12-13",0.0],["2019-01-22",0.0],["2019-01-23",0.0],["2019-02-22",0.0],["2019-03-27",-0.2],["2019-03-28",0.0],["2019-04-04",0.0],["2019-04-16",0.13636363636363635],["2019-04-18",0.6],["2019-04-25",-0.05],["2019-05-02",0.0],["2019-05-12",0.0],["2019-06-09",0.0],["2019-07-10",0.0625],["2019-07-24",0.0],["2019-09-09",0.0],["2019-09-20",0.2],["2019-10-02",0.0]]

facebookScores = [["2018-11-05",-0.1],["2018-11-06",0.0],["2018-11-07",0.0],["2018-11-11",0.0],["2018-11-15",-0.1],["2018-11-19",0.0],["2018-11-20",-0.2333333333333333],["2018-11-21",0.4166666666666667],["2018-11-22",-0.2],["2018-11-24",0.0],["2018-11-25",-0.2],["2018-11-26",-0.6999999999999998],["2018-11-27",-0.28541666666666665],["2018-11-28",-0.2],["2018-11-29",0.0],["2018-12-01",-0.4],["2018-12-02",0.0],["2018-12-03",0.2166666666666667],["2018-12-04",-0.06666666666666665],["2018-12-06",0.15],["2018-12-07",0.0],["2018-12-08",0.19285714285714284],["2018-12-09",0.0],["2018-12-10",-0.025],["2018-12-11",0.13636363636363635],["2018-12-12",0.1],["2018-12-13",-0.0744949494949495],["2018-12-14",-0.16666666666666666],["2018-12-15",0.0],["2018-12-17",0.011111111111111112],["2018-12-18",0.10972222222222221],["2018-12-19",0.06],["2018-12-20",0.125],["2018-12-21",0.0],["2018-12-22",0.1],["2018-12-24",-0.75],["2018-12-26",0.0],["2019-01-08",-0.07777777777777779],["2019-01-10",0.04166666666666666],["2019-01-14",0.3],["2019-01-17",0.0],["2019-01-21",0.0],["2019-01-23",0.0],["2019-01-25",0.20000000000000004],["2019-01-27",0.0],["2019-01-28",-0.16666666666666666],["2019-01-29",-0.056249999999999994],["2019-01-30",-0.07777777777777779],["2019-01-31",-0.006507936507936513],["2019-02-01",-0.03333333333333333],["2019-02-04",0.0],["2019-02-05",0.0],["2019-02-06",0.0],["2019-02-07",-0.02003367003367004],["2019-02-08",0.0],["2019-02-10",0.0],["2019-02-12",0.0],["2019-02-15",0.25],["2019-02-16",0.0],["2019-02-17",0.0],["2019-02-18",-0.08571428571428572],["2019-02-19",0.14285714285714285],["2019-02-20",0.0],["2019-02-21",-0.05],["2019-02-23",0.0],["2019-02-24",0.0],["2019-02-26",0.0],["2019-02-28",-0.16666666666666666],["2019-03-02",0.0],["2019-03-04",0.0],["2019-03-07",-0.05311447811447813],["2019-03-08",0.0],["2019-03-09",0.0625],["2019-03-10",0.2857142857142857],["2019-03-12",0.0],["2019-03-13",0.0],["2019-03-14",-0.13333333333333333],["2019-03-17",0.20984848484848484],["2019-03-18",0.03333333333333333],["2019-03-19",-0.07777777777777779],["2019-03-20",-0.375],["2019-03-21",0.06818181818181818],["2019-03-22",0.0],["2019-03-26",0.0],["2019-03-28",0.0],["2019-03-29",0.06818181818181818],["2019-04-01",0.04545454545454545],["2019-04-03",-0.10000000000000002],["2019-04-04",-0.010416666666666666],["2019-04-07",0.2],["2019-04-08",0.06818181818181818],["2019-04-09",-0.06666666666666667],["2019-04-11",-0.25],["2019-04-12",0.0],["2019-04-15",0.0],["2019-04-16",-0.8],["2019-04-17",0.0],["2019-04-18",0.08333333333333333],["2019-04-20",-0.5],["2019-04-22",-0.33194444444444443],["2019-04-23",0.0],["2019-04-24",0.4166666666666667],["2019-04-25",-0.038888888888888896],["2019-04-28",0.5],["2019-04-29",0.0],["2019-04-30",-0.1],["2019-05-01",0.041666666666666664],["2019-05-02",-0.125],["2019-05-05",0.0],["2019-05-06",0.0],["2019-05-08",0.0],["2019-05-09",0.6],["2019-05-12",0.0],["2019-05-14",0.0],["2019-05-15",0.0],["2019-05-16",0.0],["2019-05-17",0.3],["2019-05-18",-0.5],["2019-05-23",0.0],["2019-05-24",-0.25],["2019-05-26",-0.25],["2019-05-27",0.0],["2019-05-30",-0.09166666666666669],["2019-05-31",0.21999999999999997],["2019-06-02",0.0],["2019-06-04",0.0],["2019-06-07",0.25],["2019-06-11",0.0],["2019-06-12",-0.25],["2019-06-16",0.2],["2019-06-18",0.02727272727272727],["2019-06-19",-0.06060606060606061],["2019-06-20",0.06818181818181818],["2019-06-21",-0.06666666666666667],["2019-06-22",0.0],["2019-06-23",0.06666666666666667],["2019-06-24",0.19999999999999998],["2019-06-25",0.16666666666666666],["2019-06-27",0.0],["2019-06-28",0.06818181818181818],["2019-06-30",-0.06666666666666667],["2019-07-01",0.049999999999999996],["2019-07-02",-0.16666666666666666],["2019-07-03",0.0],["2019-07-05",0.06785714285714285],["2019-07-06",0.0],["2019-07-08",0.4],["2019-07-09",0.0],["2019-07-12",0.0],["2019-07-14",0.0],["2019-07-22",0.0],["2019-07-24",0.09734848484848485],["2019-07-25",0.0],["2019-07-26",0.0],["2019-07-29",0.03125],["2019-07-30",-0.125],["2019-08-01",-0.11666666666666668],["2019-08-02",0.0],["2019-08-04",-0.075],["2019-08-05",-0.25],["2019-08-06",-0.16666666666666666],["2019-08-07",0.0],["2019-08-09",-0.09999999999999999],["2019-08-12",0.0],["2019-08-13",-0.5],["2019-08-14",0.0],["2019-08-20",0.10000000000000002],["2019-08-23",0.1],["2019-08-27",0.13636363636363635],["2019-08-31",0.0],["2019-09-02",1.0],["2019-09-04",0.05],["2019-09-06",0.0],["2019-09-09",0.0],["2019-09-12",-0.525],["2019-09-13",0.0],["2019-09-17",0.0],["2019-09-18",0.17532467532467533],["2019-09-20",0.0],["2019-09-22",0.0],["2019-09-30",0.0],["2019-10-01",0.0],["2019-10-03",-0.11805555555555554],["2019-10-04",-0.10000000000000002],["2019-10-07",0.0],["2019-10-08",0.0],["2019-10-09",0.125],["2019-10-11",0.15],["2019-10-12",-0.4000000000000001],["2019-10-15",0.0],["2019-10-16",0.25],["2019-10-18",0.2],["2019-10-20",0.1],["2019-10-22",0.0],["2019-10-23",-0.03333333333333333],["2019-10-25",0.0740909090909091],["2019-10-26",0.0],["2019-10-28",0.0],["2019-10-29",-0.16666666666666666],["2019-10-30",0.21222222222222223],["2019-10-31",-0.03125],["2019-11-01",0.0]]

#Add data into the DB
# for item in microSoftScores:
#     temp = str(item[1])
#     response = table.put_item(
#         Item={
#             'company' : 'Microsoft',
#             'date': item[0],
#             'ticker' : 'MSFT',
#             'polarity_score' : temp,
#         }
#     )
#     print(response)
